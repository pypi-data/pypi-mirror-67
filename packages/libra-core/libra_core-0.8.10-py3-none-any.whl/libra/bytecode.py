import json

bytecodes = {
    'add_validator' : b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x03\x00\x00\x00\x07I\x00\x00\x00!\x00\x00\x00\x08j\x00\x00\x00\x10\x00\x00\x00\tz\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\x05\x00\x06<SELF>\x0bLibraSystem\radd_validator\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\n\x00\x11\x00\x02',

    'remove_validator' : b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x03\x00\x00\x00\x07I\x00\x00\x00$\x00\x00\x00\x08m\x00\x00\x00\x10\x00\x00\x00\t}\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\x05\x00\x06<SELF>\x0bLibraSystem\x10remove_validator\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\n\x00\x11\x00\x02',

    'register_validator' : b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x0e\x00\x00\x00\x07T\x00\x00\x004\x00\x00\x00\x08\x88\x00\x00\x00\x10\x00\x00\x00\t\x98\x00\x00\x00\x14\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x06\n\x02\n\x02\n\x02\n\x02\n\x02\n\x02\x00\x06<SELF>\x0fValidatorConfig\x1cregister_candidate_validator\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x0b\x00\x0b\x01\x0b\x02\x0b\x03\x0b\x04\x0b\x05\x11\x00\x02',

    'peer_to_peer' : b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x11\x00\x00\x00\x04[\x00\x00\x00\x04\x00\x00\x00\x05_\x00\x00\x00\x14\x00\x00\x00\x07s\x00\x00\x00C\x00\x00\x00\x08\xb6\x00\x00\x00\x10\x00\x00\x00\t\xc6\x00\x00\x00\x1e\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x01\x01\x01\x03\x02\x03\x00\x01\x04\x04\x01\x01\x01\x00\x06\x02\x06\x02\x05\n\x02\x00\x01\x05\x01\x01\x02\x05\x03\x03\x05\n\x02\x03\x01\t\x00\x06<SELF>\x0cLibraAccount\x17create_unhosted_account\x06exists\x0fpay_from_sender\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x05\x05\x0c\x00\n\x00\x11\x01 \x03\x05\x00\x05\x08\x00\n\x00\n\x01=\x00\n\x00\n\x02=\x01\x02',

    'peer_to_peer_with_metadata' : b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x11\x00\x00\x00\x04[\x00\x00\x00\x04\x00\x00\x00\x05_\x00\x00\x00\x18\x00\x00\x00\x07w\x00\x00\x00Q\x00\x00\x00\x08\xc8\x00\x00\x00\x10\x00\x00\x00\t\xd8\x00\x00\x00 \x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x01\x01\x01\x03\x02\x03\x00\x01\x04\x04\x01\x01\x01\x00\x06\x02\x06\x02\x05\n\x02\x00\x01\x05\x01\x01\x03\x05\x03\n\x02\x04\x05\n\x02\x03\n\x02\x01\t\x00\x06<SELF>\x0cLibraAccount\x17create_unhosted_account\x06exists\x1dpay_from_sender_with_metadata\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x05\x05\r\x00\n\x00\x11\x01 \x03\x05\x00\x05\x08\x00\n\x00\n\x01=\x00\n\x00\n\x02\x0b\x03=\x01\x02',

    'create_account' : b"\xa1\x1c\xeb\x0b\x01\x00\x08\x01O\x00\x00\x00\x06\x00\x00\x00\x02U\x00\x00\x00\x05\x00\x00\x00\x03Z\x00\x00\x00\x12\x00\x00\x00\x04l\x00\x00\x00\x06\x00\x00\x00\x05r\x00\x00\x00\x1c\x00\x00\x00\x07\x8e\x00\x00\x00Q\x00\x00\x00\x08\xdf\x00\x00\x00\x10\x00\x00\x00\t\xef\x00\x00\x00'\x00\x00\x00\x00\x00\x00\x01\x00\x02\x01\x03\x01\x01\x01\x02\x04\x00\x01\x01\x01\x02\x05\x02\x01\x01\x01\x02\x06\x03\x04\x01\x01\x00\x06\x02\x06\x01\x06\x02\x05\n\x02\x00\x02\x05\x0b\x00\x01\t\x00\x01\x03\x01\x0b\x00\x01\t\x00\x03\x05\n\x02\x03\x01\t\x00\x06<SELF>\x05Libra\x0cLibraAccount\x01T\x17create_unhosted_account\x07deposit\x14withdraw_from_sender\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x05\x05\r\x00\n\x00\x0b\x01=\x00\n\x02\x06\x00\x00\x00\x00\x00\x00\x00\x00$\x03\x08\x00\x05\x0c\x00\n\x00\n\x02=\x01=\x02\x02",

    'mint' : b'\xa1\x1c\xeb\x0b\x01\x00\x07\x01F\x00\x00\x00\x04\x00\x00\x00\x03J\x00\x00\x00\x11\x00\x00\x00\x04[\x00\x00\x00\x04\x00\x00\x00\x05_\x00\x00\x00\x14\x00\x00\x00\x07s\x00\x00\x00C\x00\x00\x00\x08\xb6\x00\x00\x00\x10\x00\x00\x00\t\xc6\x00\x00\x00\x1e\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x01\x01\x01\x03\x02\x03\x00\x01\x04\x04\x01\x01\x01\x00\x06\x02\x06\x02\x05\n\x02\x00\x01\x05\x01\x01\x02\x05\x03\x03\x05\n\x02\x03\x01\t\x00\x06<SELF>\x0cLibraAccount\x17create_unhosted_account\x06exists\x0fmint_to_address\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x05\x05\x0c\x00\n\x00\x11\x01 \x03\x05\x00\x05\x08\x00\n\x00\x0b\x01=\x00\n\x00\n\x02=\x01\x02',

    'rotate_authentication_key' : b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x04\x00\x00\x00\x07J\x00\x00\x00.\x00\x00\x00\x08x\x00\x00\x00\x10\x00\x00\x00\t\x88\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\n\x02\x00\x06<SELF>\x0cLibraAccount\x19rotate_authentication_key\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x0b\x00\x11\x00\x02',

    'rotate_consensus_pubkey' : b'\xa1\x1c\xeb\x0b\x01\x00\x06\x01=\x00\x00\x00\x04\x00\x00\x00\x03A\x00\x00\x00\x05\x00\x00\x00\x05F\x00\x00\x00\x04\x00\x00\x00\x07J\x00\x00\x00+\x00\x00\x00\x08u\x00\x00\x00\x10\x00\x00\x00\t\x85\x00\x00\x00\n\x00\x00\x00\x00\x00\x00\x01\x01\x02\x00\x01\x00\x01\n\x02\x00\x06<SELF>\x0bLibraSystem\x17rotate_consensus_pubkey\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x0b\x00\x11\x00\x02',
}


def get_transaction_name(code):
    for k, v in bytecodes.items():
        if code == v:
            return k + "_transaction"
    return "unknown transaction"


def get_code_by_jsonfile(script_file):
    with open(script_file) as f:
        amap = json.load(f)
        return bytes(amap['code'])


def get_code_by_filename(script_file):
    with open(script_file, 'rb') as f:
        code = f.read()
        return code
