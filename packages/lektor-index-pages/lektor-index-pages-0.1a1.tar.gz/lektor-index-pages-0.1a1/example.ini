[bydate]

# only for top-level indexes (Default = /)
parent = /blog
# items = this.children.order_by('-pub_date')

# slug = 'year-index/{}'.format(this._id)
keys = "{0.year:04d}".format(this.pub_date)
# default = index-pages.html
template = year-index.html
#
subindex = bymonth

[bydate.attributes]
# FIXME: rename attributes to fields?
date = this.children.first().pub_date.replace(month=1, day=1)
year = this.date.year

[bydate.bymonth]
keys = "{:02d}".format(this.pub_date)
template = month-index.html

[bydate.bymonth.attributes]
# How to set date attribute?
date = this.parent.date.replace(month=int(this._id))
year = this.date.year
month = thie.date.month

[bydate.pagination]

enabled = yes
per_page = 10
# url_suffix = page

################################################################
# And a tag index, too

[tags]
parent = /blog

keys = this.tags
template = tag_index.html

slug = 'tag/%s'|format(this._id)

[tags.attributes]
tag = this._id
