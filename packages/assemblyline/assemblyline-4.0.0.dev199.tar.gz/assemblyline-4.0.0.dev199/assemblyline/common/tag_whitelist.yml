# Default tag_whitelist.yml file
#
#    The following tags are whitelisted:
#     - Domains pointing to localhost
#     - IPs in the private network IP space
#     - URI pointing to IPs in the private network IP space
#
#    Note: - You can override the default tag_whitelist.yml by putting an
#            updated version in /etc/assemblyline/tag_whitelist.yml.
#          - If you want to add values to one of the following tag types,
#            you have to copy the default values to the new file.
#          - You can nullify value by putting empty object or empty list
#            in your new file

# Match section contains tag types and for each tag type
#  a list of values that should be whitelisted using a direct
#  string comparison.
match:
  # Direct match to dynamic domains
  network.dynamic.domain:
    - localhost
    - android.googlesource.com
    - play.google.com
    - schemas.android.com
    - xmlpull.org
    - schemas.openxmlformats.org
    - schemas.microsoft.com
    - settings-win.data.microsoft.com
    - vortex-win.data.microsoft.com
    - wpad.reddog.microsoft.com
    - verisign.com
    - csc3-2010-crl.verisign.com
    - csc3-2010-aia.verisign.com
    - ocsp.verisign.com
    - logo.verisign.com
    - crl.verisign.com
  # Direct match to static domains
  network.static.domain:
    - localhost
    - android.googlesource.com
    - play.google.com
    - schemas.android.com
    - xmlpull.org
    - schemas.openxmlformats.org
    - schemas.microsoft.com
    - settings-win.data.microsoft.com
    - vortex-win.data.microsoft.com
    - wpad.reddog.microsoft.com
    - verisign.com
    - csc3-2010-crl.verisign.com
    - csc3-2010-aia.verisign.com
    - ocsp.verisign.com
    - logo.verisign.com
    - crl.verisign.com

# Regex section contains tag types and for each tag type
#  a list of regular expression to be run to whitelist
#  the associated tags.
regex:
  # Regular expression to whitelist dynamic IPs (Private IPs)
  #  note: Since IPs have already been validated, the regular expression in simpler
  network.dynamic.ip:
    - (?:127\.|10\.|192\.168|172\.1[6-9]\.|172\.2[0-9]\.|172\.3[01]\.).*
  # Regular expression to whitelist static IPs (Private IPs)
  #  note: Since IPs have already been validated, the regular expression in simpler
  network.static.ip:
    - (?:127\.|10\.|192\.168|172\.1[6-9]\.|172\.2[0-9]\.|172\.3[01]\.).*
  # Regular expression to whitelist dynamic URIs (Private IPs and localhost)
  network.dynamic.uri:
    - (?:ftp|http)s?://localhost(?:$|/.*)
    - (?:ftp|http)s?://(?:(?:(?:10|127)(?:\.(?:[2](?:[0-5][0-5]|[01234][6-9])|[1][0-9][0-9]|[1-9][0-9]|[0-9])){3})|(?:172\.(?:1[6-9]|2[0-9]|3[0-1])(?:\.(?:2[0-4][0-9]|25[0-5]|[1][0-9][0-9]|[1-9][0-9]|[0-9])){2}|(?:192\.168(?:\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){2})))(?:$|/.*)
    - (?:http):\/\/schemas\.android\.com\/apk\/res(-auto|\/android)
    - (?:http):\/\/xmlpull\.org\/v1\/doc\/features\.html(?:$|.*)
    - (?:http)s:\/\/android\.googlesource\.com\/toolchain\/llvm-project
    - (?:http):\/\/schemas\.microsoft\.com(?:$|\/.*)
    - (?:http):\/\/schemas\.openxmlformats\.org(?:$|\/.*)
    - (:?http):\/\/schemas\.openxmlformats\.org\/officeDocument\/2006\/relationships\/(image|attachedTemplate|header|footnotes|fontTable|customXml|endnotes|theme|settings|webSettings|glossaryDocument|numbering|footer|styles)
    - (:?http):\/\/schemas\.microsoft.com\/office\/word\/2010\/(wordml|wordprocessingCanvas|wordprocessingInk|wordprocessingGroup|wordprocessingDrawing)
    - (:?http):\/\/schemas\.microsoft.com\/office\/word\/(2012|2006)\/wordml
    - (:?http):\/\/schemas\.microsoft.com\/office\/word\/2015\/wordml\/symex
    - (:?http):\/\/schemas\.microsoft.com\/office\/drawing\/2014\/chartex
    - (:?http):\/\/schemas\.microsoft.com\/office\/drawing\/2015\/9\/8\/chartex
    - (:?http):\/\/schemas\.openxmlformats\.org\/drawingml\/2006\/(main|wordprocessingDrawing)
    - (:?http):\/\/schemas\.openxmlformats\.org\/package\/2006\/relationships
    - (:?http):\/\/schemas\.openxmlformats\.org\/markup-compatibility\/2006
    - (:?http):\/\/schemas\.openxmlformats\.org\/officeDocument\/2006\/(relationships|math)
    - (:?http):\/\/schemas\.openxmlformats\.org\/word\/2010\/wordprocessingShape
    - (:?http):\/\/schemas\.openxmlformats\.org\/wordprocessingml\/2006\/main
    - (?:https):\/\/www.verisign.com\/(rpa0|rpa|cps0)
    - (?:http):\/\/wpad.reddog.microsoft.com\/wpad.dat
    - (?:http):\/\/ocsp.verisign.com
    - (?:http):\/\/logo.verisign.com\/vslogo.gif04
    - (?:http):\/\/crl.verisign.com\/pca3-g5.crl04
    - (?:http):\/\/csc3-2010-crl.verisign.com\/CSC3-2010\.crl0D
    - (?:http):\/\/csc3-2010-aia.verisign.com\/CSC3-2010\.cer0
  # Regular expression to whitelist static URIs (Private IPs and localhost)
  network.static.uri:
    - (?:ftp|http)s?://localhost(?:$|/.*)
    - (?:ftp|http)s?://(?:(?:(?:10|127)(?:\.(?:[2](?:[0-5][0-5]|[01234][6-9])|[1][0-9][0-9]|[1-9][0-9]|[0-9])){3})|(?:172\.(?:1[6-9]|2[0-9]|3[0-1])(?:\.(?:2[0-4][0-9]|25[0-5]|[1][0-9][0-9]|[1-9][0-9]|[0-9])){2}|(?:192\.168(?:\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){2})))(?:$|/.*)
    - (?:http):\/\/schemas\.android\.com\/apk\/res(-auto|\/android)
    - (?:http):\/\/xmlpull\.org\/v1\/doc\/features\.html(?:$|.*)
    - (?:http)s:\/\/android\.googlesource\.com\/toolchain\/llvm-project
    - (?:http):\/\/schemas\.microsoft\.com(?:$|\/.*)
    - (?:http):\/\/schemas\.openxmlformats\.org(?:$|\/.*)
    - (:?http):\/\/schemas\.openxmlformats\.org\/officeDocument\/2006\/relationships\/(image|attachedTemplate|header|footnotes|fontTable|customXml|endnotes|theme|settings|webSettings|glossaryDocument|numbering|footer|styles)
    - (:?http):\/\/schemas\.microsoft.com\/office\/word\/2010\/(wordml|wordprocessingCanvas|wordprocessingInk|wordprocessingGroup|wordprocessingDrawing)
    - (:?http):\/\/schemas\.microsoft.com\/office\/word\/(2012|2006)\/wordml
    - (:?http):\/\/schemas\.microsoft.com\/office\/word\/2015\/wordml\/symex
    - (:?http):\/\/schemas\.microsoft.com\/office\/drawing\/2014\/chartex
    - (:?http):\/\/schemas\.microsoft.com\/office\/drawing\/2015\/9\/8\/chartex
    - (:?http):\/\/schemas\.openxmlformats\.org\/drawingml\/2006\/(main|wordprocessingDrawing)
    - (:?http):\/\/schemas\.openxmlformats\.org\/package\/2006\/relationships
    - (:?http):\/\/schemas\.openxmlformats\.org\/markup-compatibility\/2006
    - (:?http):\/\/schemas\.openxmlformats\.org\/officeDocument\/2006\/(relationships|math)
    - (:?http):\/\/schemas\.openxmlformats\.org\/word\/2010\/wordprocessingShape
    - (:?http):\/\/schemas\.openxmlformats\.org\/wordprocessingml\/2006\/main
    - (?:https):\/\/www.verisign.com\/(rpa0|rpa|cps0)
    - (?:http):\/\/wpad.reddog.microsoft.com\/wpad.dat
    - (?:http):\/\/ocsp.verisign.com
    - (?:http):\/\/logo.verisign.com\/vslogo.gif04
    - (?:http):\/\/crl.verisign.com\/pca3-g5.crl04
    - (?:http):\/\/csc3-2010-crl.verisign.com\/CSC3-2010\.crl0D
    - (?:http):\/\/csc3-2010-aia.verisign.com\/CSC3-2010\.cer0