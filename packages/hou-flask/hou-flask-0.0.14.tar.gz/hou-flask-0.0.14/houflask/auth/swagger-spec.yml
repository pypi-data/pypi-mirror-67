openapi: 3.0.0

servers:
  - description: For local dev only
    url: /authentication

info:
  description: A cool tool
  title: Auth
  version: 0.0.1

paths:
  /csrf_token:
    get:
      operationId: houflask.auth.views.authentication_view.get_csrf_token
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  csrf_token:
                    type: string
                required:
                  - csrf_token
                type: object
          description: The CSRF token
      summary: Get an anti-CSRF token to use when updating data
  /register:
    post:
      operationId: houflask.auth.views.authentication_view.register
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AccountRegister'
        description: Your login credentials
        required: true
      responses:
        '201':
          content:
            application/json:
              schema:
                type: object
                required:
                  - message
                properties:
                  message:
                    type: string
          description: A message for finishing registration
        '500':
          $ref: '#/components/responses/ServerError'
  /login:
    post:
      operationId: houflask.auth.views.authentication_view.login
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
                - remember
              properties:
                username:
                  type: string
                password:
                  type: string
                remember:
                  type: boolean
        description: Your login credentials
        required: true
      responses:
        '200':
          description: Successfully logged in
          content:
            application/json:
              schema:
                type: object
                required:
                  - success
                properties:
                  success:
                    type: boolean
        '500':
          $ref: '#/components/responses/ServerError'
  /logout:
    get:
      operationId: houflask.auth.views.authentication_view.logout
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  login_url:
                    type: string
                  success:
                    type: boolean
                required:
                  - success
                  - login_url
                type: object
          description: Successfully logged out
        '500':
          $ref: '#/components/responses/ServerError'

components:
  responses:
    ServerError:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ServerErrorMessage'
      description: Something went wrong.  Please try again later
  schemas:
    AccountRegister:
      properties:
        confirm_password:
          type: string
          title: Confirm Password
        email:
          $ref: '#/components/schemas/Email'
        password:
          $ref: '#/components/schemas/Password'
      required:
        - email
        - password
        - confirm_password
      type: object
    Email:
      format: email
      maxLength: 128
      pattern: ^.+@.+$
      title: Email
      type: string
    Password:
      maxLength: 71
      minLength: 8
      title: Password
      type: string
    ServerErrorMessage:
      properties:
        error_type:
          type: string
        message:
          type: string
      required:
        - message
        - error_type
      type: object
