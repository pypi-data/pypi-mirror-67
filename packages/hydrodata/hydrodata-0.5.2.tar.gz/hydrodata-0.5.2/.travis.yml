os:
- linux
language: python
python:
- 3.8
- 3.7
- 3.6
jobs:
  include:
  - os: osx
    language: generic
    env: TOXENV=py36
  - os: osx
    language: generic
    env: TOXENV=py37
  - os: osx
    language: generic
    env: TOXENV=py38
before_install:
- if [ $(uname) = "Darwin" ]; then export TRAVIS_PYTHON_VERSION="`sed 's/^..//; s/./&./'
  <(echo $TOXENV)`"; brew update > /dev/null 2>&1; brew install gnu-sed > /dev/null
  2>&1; gsed -i "s|python.*|python=${TRAVIS_PYTHON_VERSION}|" environment_ci.yml;
  wget https://repo.anaconda.com/miniconda/Miniconda3-latest-MacOSX-x86_64.sh -O miniconda.sh;
  else sed -i "s|python.*|python=${TRAVIS_PYTHON_VERSION}|" environment_ci.yml; wget
  https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh;
  fi
- bash miniconda.sh -b -p $HOME/miniconda
- source "$HOME/miniconda/etc/profile.d/conda.sh"
- hash -r
- conda config --set always_yes yes --set changeps1 no
- conda update -q conda
- conda info -a
- conda env create -f environment_ci.yml
- conda activate hydrodata-ci
install:
- python setup.py install
script: tox
after_success:
- bash <(curl -s https://codecov.io/bash)
deploy:
  provider: pypi
  distributions: sdist bdist_wheel
  user: tchegini
  password:
    secure: AargDcmZ9aveeGtoXXe17ieYomoLgcwEsqmCvnIgsOCDKr0S7GssOtBchnoHxEDMKEYzjV3hFl5IKjP/yeFgdB5FMsqUHJOXPk6pPX5nwyA0zdx3EhYsPXM+bJ0GqgeDQSV/84b9OYBlKGUaxGjE7TTTQgOy9VkHRhqatqkHYob58Zfx2rHsg+36qiqNoY/HSzh/FyAFglu1nyJOvV6fjq2r8pzbuE4FAqDxMOc2W4yX85aBPOxfC3fczFvPOHKj77C2xtVwRwBkp9erNzFy/53LaWujMXfW+5RXmS/lXXEc1lnY1rD6hUihLmRYQJ04gJzW+toTMJxiOBbvvXVj+ZNvC5a0F+eX122GyfBTC0jDulAeqfEokhy+yFBdy170Pi9xL+RrDBQprq3gsCHceFQmCL52Wnck1aKcnTKA4lRGAYUAfa0ZKfL+14W0Yd4t0VS5JeFKFzUec4FFtJF+5BJdHF1Aw9Nd6yjCUxKqm8JTH8MfhQ2sr+vv5GeEHiY0l9cu4rsS+EV6md0wfLrveq2Bu2YcyAp/2EZ6LMqoUF5Ls9hZimB08nXD+ZRz4rrgXl4jdwV63JBPxEeJVoAlXUPxX3vc4XQyKXWnfAs9xu9dbmR+n8tC6dcdSQE5KMZFejIGI+5lhztHLNTpizrIl99pkciwYXdcmKcLodAdoMs=
  on:
    tags: true
    repo: cheginit/hydrodata
    python: 3.8
notifications:
  email: false
