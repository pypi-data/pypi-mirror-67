{"version":3,"sources":["webpack:///./src/containers/certification-dashboard/certification-dashboard.scss","webpack:///./src/containers/certification-dashboard/certification-dashboard.scss?0af1","webpack:///./src/containers/token/token.tsx","webpack:///./src/containers/certification-dashboard/certification-dashboard.tsx"],"names":["module","exports","push","i","content","options","transform","undefined","update","locals","hot","accept","newContent","a","b","key","idx","Error","dispose","props","state","tokenData","componentDidMount","INSIGHTS_DEPLOYMENT_MODE","window","insights","chrome","auth","getOfflineToken","then","result","setState","data","render","title","className","refresh_token","onClick","loadToken","href","target","doOffline","getToken","TokenPage","params","parseParamString","location","search","needsReview","versions","itemCount","loading","updatingVersions","redirect","alerts","isPartnerEngineer","response","is_partner_engineer","queryCollections","notFound","to","this","closeAlert","updateParams","p","filterConfig","id","inputType","type","count","isTop","ignoredParams","renderTable","length","variant","full","icon","headingLevel","size","map","version","renderRow","renderStatus","includes","certification","certified","notCertified","index","namespace","name","collection","created_at","fromNow","renderButtons","importsLink","component","myImports","certifyDropDown","isDisabled","updateCertification","rejectDropDown","items","concat","setCertifiation","list","updatedVersion","newVersionList","ind","findIndex","x","filter","v","catch","error","status","description","meta","updateParamsMixin","CertificationDashboard"],"mappings":"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","file":"js/settings.js","sourcesContent":["exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".toolbar {\\n  padding-bottom: 16px;\\n  display: flex;\\n  justify-content: space-between; }\\n\\n.certified-icon {\\n  color: var(--pf-global--success-color--100); }\\n\\n.rejected-icon {\\n  color: var(--pf-global--danger-color--100); }\\n\\n.needs-review-icon {\\n  color: var(--pf-global--info-color--100); }\\n\\n.control-column {\\n  display: flex;\\n  justify-content: flex-end;\\n  align-items: center; }\\n\\n.footer {\\n  padding-top: 16px; }\\n\\n.updating-spinner {\\n  color: var(--pf-global--info-color--100); }\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/lib/loader.js!./certification-dashboard.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/lib/loader.js!./certification-dashboard.scss\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/lib/loader.js!./certification-dashboard.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","import * as React from 'react';\n\nimport { withRouter, RouteComponentProps } from 'react-router-dom';\nimport { Section } from '@redhat-cloud-services/frontend-components';\nimport { ClipboardCopy, Button } from '@patternfly/react-core';\n\nimport { BaseHeader, Main } from '../../components';\nimport { Constants } from '../../constants';\nimport { UserAPI } from '../../api';\n\ninterface IState {\n  tokenData: {\n    access_token: string;\n    expires_in: number;\n    id_token: string;\n    refresh_expires_in: number;\n    refresh_token: string;\n    scope: string;\n    session_state: string;\n    token_type: string;\n  };\n}\n\nclass TokenPage extends React.Component<RouteComponentProps, IState> {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      tokenData: undefined,\n    };\n  }\n\n  componentDidMount() {\n    if (DEPLOYMENT_MODE === Constants.INSIGHTS_DEPLOYMENT_MODE) {\n      // this function will fail if chrome.auth.doOffline() hasn't been called\n      (window as any).insights.chrome.auth.getOfflineToken().then(result => {\n        this.setState({ tokenData: result.data });\n      });\n    }\n  }\n\n  render() {\n    const { tokenData } = this.state;\n\n    return (\n      <React.Fragment>\n        <BaseHeader title='Token management'></BaseHeader>\n        <Main>\n          <Section className='body pf-c-content'>\n            <h2>Offline token</h2>\n            <p>\n              Use this token to authenticate the <code>ansible-galaxy</code>{' '}\n              client.\n            </p>\n            {tokenData ? (\n              <div>\n                <ClipboardCopy>{tokenData.refresh_token}</ClipboardCopy>\n              </div>\n            ) : (\n              <Button onClick={() => this.loadToken()}>Load token</Button>\n            )}\n            <h2>Manage tokens</h2>\n            To remove an existing token, visit{' '}\n            <a\n              href='https://sso.redhat.com/auth/realms/redhat-external/account/'\n              target='_blank'\n            >\n              Red Hat SSO account managment\n            </a>\n            .\n          </Section>\n        </Main>\n      </React.Fragment>\n    );\n  }\n\n  private loadToken() {\n    if (DEPLOYMENT_MODE === Constants.INSIGHTS_DEPLOYMENT_MODE) {\n      (window as any).insights.chrome.auth\n        // doOffline causes the page to refresh and will make the data\n        // available to getOfflineToken() when the component mounts after\n        // the reload\n        .doOffline();\n    } else {\n      UserAPI.getToken().then(result => this.setState({ tokenData: result }));\n    }\n  }\n}\n\nexport default withRouter(TokenPage);\n","import * as React from 'react';\nimport './certification-dashboard.scss';\n\nimport * as moment from 'moment';\nimport {\n  withRouter,\n  RouteComponentProps,\n  Link,\n  Redirect,\n} from 'react-router-dom';\nimport { BaseHeader, Main } from '../../components';\nimport { Section } from '@redhat-cloud-services/frontend-components';\nimport {\n  Toolbar,\n  ToolbarGroup,\n  ToolbarItem,\n  Button,\n  DropdownItem,\n  EmptyState,\n  EmptyStateIcon,\n  Title,\n  EmptyStateBody,\n  EmptyStateVariant,\n} from '@patternfly/react-core';\n\nimport {\n  InfoCircleIcon,\n  ExclamationCircleIcon,\n  CheckCircleIcon,\n  WarningTriangleIcon,\n} from '@patternfly/react-icons';\n\nimport {\n  CollectionVersionAPI,\n  CollectionVersion,\n  CertificationStatus,\n  UserAPI,\n  MeType,\n} from '../../api';\nimport { ParamHelper } from '../../utilities';\nimport {\n  LoadingPageWithHeader,\n  StatefulDropdown,\n  CompoundFilter,\n  LoadingPageSpinner,\n  AppliedFilters,\n  Pagination,\n  Sort,\n  AlertList,\n  closeAlertMixin,\n  AlertType,\n  SortFieldType,\n} from '../../components';\nimport { Paths, formatPath } from '../../paths';\n\ninterface IState {\n  params: {\n    certification?: string;\n    namespace?: string;\n    collection?: string;\n    page?: number;\n    page_size?: number;\n  };\n  alerts: AlertType[];\n  versions: CollectionVersion[];\n  itemCount: number;\n  loading: boolean;\n  updatingVersions: string[];\n  redirect: string;\n}\n\nclass CertificationDashboard extends React.Component<\n  RouteComponentProps,\n  IState\n> {\n  constructor(props) {\n    super(props);\n\n    const params = ParamHelper.parseParamString(props.location.search, [\n      'page',\n      'page_size',\n    ]);\n\n    if (!params['page_size']) {\n      params['page_size'] = 10;\n    }\n\n    if (!params['sort']) {\n      params['sort'] = '-pulp_created';\n    }\n\n    if (!params['certification']) {\n      params['certification'] = CertificationStatus.needsReview;\n    }\n\n    this.state = {\n      versions: undefined,\n      itemCount: 0,\n      params: params,\n      loading: true,\n      updatingVersions: [],\n      redirect: undefined,\n      alerts: [],\n    };\n  }\n\n  componentDidMount() {\n    UserAPI.isPartnerEngineer().then(response => {\n      const me: MeType = response.data;\n      if (!me.is_partner_engineer) {\n        this.setState({ redirect: Paths.notFound });\n      } else {\n        this.queryCollections();\n      }\n    });\n  }\n\n  render() {\n    const { versions, params, itemCount, loading, redirect } = this.state;\n\n    if (redirect) {\n      return <Redirect to={redirect}></Redirect>;\n    }\n\n    const sortOptions: SortFieldType[] = [\n      {\n        id: 'pulp_created',\n        title: 'Date created',\n        type: 'numeric',\n      },\n      { id: 'namespace', title: 'Namespace name', type: 'alpha' },\n      { id: 'version', title: 'Version number', type: 'numeric' },\n      { id: 'name', title: 'Collection name', type: 'alpha' },\n    ];\n\n    if (!versions) {\n      return <LoadingPageWithHeader></LoadingPageWithHeader>;\n    }\n    return (\n      <React.Fragment>\n        <BaseHeader title='Certification dashboard'></BaseHeader>\n        <AlertList\n          alerts={this.state.alerts}\n          closeAlert={i => this.closeAlert(i)}\n        />\n        <Main>\n          <Section className='body'>\n            <div className='toolbar'>\n              <Toolbar>\n                <ToolbarGroup>\n                  <ToolbarItem>\n                    <CompoundFilter\n                      updateParams={p =>\n                        this.updateParams(p, () => this.queryCollections())\n                      }\n                      params={params}\n                      filterConfig={[\n                        {\n                          id: 'namespace',\n                          title: 'Namespace',\n                        },\n                        {\n                          id: 'name',\n                          title: 'Collection Name',\n                        },\n                        {\n                          id: 'certification',\n                          title: 'Certification Status',\n                          inputType: 'select',\n                          options: [\n                            {\n                              id: 'not_certified',\n                              title: 'Rejected',\n                            },\n                            {\n                              id: 'needs_review',\n                              title: 'Needs Review',\n                            },\n                            {\n                              id: 'certified',\n                              title: 'Certified',\n                            },\n                          ],\n                        },\n                      ]}\n                    />\n                  </ToolbarItem>\n                </ToolbarGroup>\n                <ToolbarGroup>\n                  <ToolbarItem>\n                    <Sort\n                      options={sortOptions}\n                      params={params}\n                      updateParams={p =>\n                        this.updateParams(p, () => this.queryCollections())\n                      }\n                    />\n                  </ToolbarItem>\n                </ToolbarGroup>\n              </Toolbar>\n\n              <Pagination\n                params={params}\n                updateParams={p =>\n                  this.updateParams(p, () => this.queryCollections())\n                }\n                count={itemCount}\n                isTop\n              />\n            </div>\n            <div>\n              <AppliedFilters\n                updateParams={p =>\n                  this.updateParams(p, () => this.queryCollections())\n                }\n                params={params}\n                ignoredParams={['page_size', 'page', 'sort']}\n              />\n            </div>\n            {loading ? <LoadingPageSpinner /> : this.renderTable(versions)}\n\n            <div className='footer'>\n              <Pagination\n                params={params}\n                updateParams={p =>\n                  this.updateParams(p, () => this.queryCollections())\n                }\n                count={itemCount}\n              />\n            </div>\n          </Section>\n        </Main>\n      </React.Fragment>\n    );\n  }\n\n  private renderTable(versions) {\n    if (versions.length === 0) {\n      return (\n        <EmptyState className='empty' variant={EmptyStateVariant.full}>\n          <EmptyStateIcon icon={WarningTriangleIcon} />\n          <Title headingLevel='h2' size='lg'>\n            No matches\n          </Title>\n          <EmptyStateBody>\n            Please try adjusting your search query.\n          </EmptyStateBody>\n        </EmptyState>\n      );\n    }\n\n    return (\n      <table\n        aria-label='Collection versions'\n        className='content-table pf-c-table'\n      >\n        <thead>\n          <tr aria-labelledby='headers'>\n            <th>Namespace</th>\n            <th>Collection</th>\n            <th>Version</th>\n            <th>Date created</th>\n            <th>Status</th>\n            <th></th>\n          </tr>\n        </thead>\n        <tbody>\n          {versions.map((version, i) => this.renderRow(version, i))}\n        </tbody>\n      </table>\n    );\n  }\n\n  private renderStatus(version: CollectionVersion) {\n    if (this.state.updatingVersions.includes(version.id)) {\n      return <span className='fa fa-lg fa-spin fa-spinner' />;\n    }\n    switch (version.certification) {\n      case CertificationStatus.certified:\n        return (\n          <span>\n            <CheckCircleIcon className='certified-icon' /> Certified\n          </span>\n        );\n      case CertificationStatus.notCertified:\n        return (\n          <span>\n            <ExclamationCircleIcon className='rejected-icon' /> Rejected\n          </span>\n        );\n      case CertificationStatus.needsReview:\n        return (\n          <span>\n            <InfoCircleIcon className='needs-review-icon' /> Needs Review\n          </span>\n        );\n    }\n  }\n\n  private renderRow(version: CollectionVersion, index) {\n    return (\n      <tr\n        aria-labelledby={`${version.namespace}.${version.name} v${version.version}`}\n        key={index}\n      >\n        <td>{version.namespace}</td>\n        <td>{version.name}</td>\n        <td>\n          <Link\n            to={formatPath(\n              Paths.collection,\n              {\n                namespace: version.namespace,\n                collection: version.name,\n              },\n              {\n                version: version.version,\n              },\n            )}\n          >\n            {version.version}\n          </Link>\n        </td>\n        <td>{moment(version.created_at).fromNow()}</td>\n        <td>{this.renderStatus(version)}</td>\n        <td>\n          <div className='control-column'>\n            <div>{this.renderButtons(version)}</div>\n          </div>\n        </td>\n      </tr>\n    );\n  }\n\n  private renderButtons(version: CollectionVersion) {\n    const importsLink = (\n      <DropdownItem\n        key='imports'\n        component={\n          <Link\n            to={formatPath(\n              Paths.myImports,\n              {},\n              {\n                namespace: version.namespace,\n                name: version.name,\n                version: version.version,\n              },\n            )}\n          >\n            View Import Logs\n          </Link>\n        }\n      />\n    );\n\n    const certifyDropDown = (isDisabled: boolean) => (\n      <DropdownItem\n        onClick={() =>\n          this.updateCertification(version, CertificationStatus.certified)\n        }\n        isDisabled={isDisabled}\n        key='certify'\n      >\n        Certify\n      </DropdownItem>\n    );\n\n    const rejectDropDown = (isDisabled: boolean) => (\n      <DropdownItem\n        onClick={() =>\n          this.updateCertification(version, CertificationStatus.notCertified)\n        }\n        isDisabled={isDisabled}\n        className='rejected-icon'\n        key='reject'\n      >\n        Reject\n      </DropdownItem>\n    );\n\n    switch (version.certification) {\n      case CertificationStatus.certified:\n        return (\n          <span>\n            <StatefulDropdown\n              items={[\n                certifyDropDown(true),\n                rejectDropDown(false),\n                importsLink,\n              ]}\n            />\n          </span>\n        );\n      case CertificationStatus.notCertified:\n        return (\n          <span>\n            <StatefulDropdown\n              items={[\n                certifyDropDown(false),\n                rejectDropDown(true),\n                importsLink,\n              ]}\n            />\n          </span>\n        );\n      case CertificationStatus.needsReview:\n        return (\n          <span>\n            <Button\n              onClick={() =>\n                this.updateCertification(version, CertificationStatus.certified)\n              }\n            >\n              <span>Certify</span>\n            </Button>\n            <StatefulDropdown items={[rejectDropDown(false), importsLink]} />\n          </span>\n        );\n    }\n  }\n\n  private updateCertification(version, certification) {\n    // Set the selected version to loading\n    this.setState(\n      {\n        updatingVersions: this.state.updatingVersions.concat([version.id]),\n      },\n      () =>\n        // Perform the PUT request\n        CollectionVersionAPI.setCertifiation(\n          version.namespace,\n          version.name,\n          version.version,\n          certification,\n        )\n          .then(() =>\n            // Since pulp doesn't reply with the new object, perform a\n            // second query to get the updated data\n            CollectionVersionAPI.list({\n              namespace: version.namespace,\n              name: version.name,\n              version: version.version,\n            }).then(result => {\n              const updatedVersion = result.data.data[0];\n              const newVersionList = [...this.state.versions];\n              const ind = newVersionList.findIndex(\n                x => x.id === updatedVersion.id,\n              );\n              newVersionList[ind] = updatedVersion;\n\n              this.setState({\n                versions: newVersionList,\n                updatingVersions: this.state.updatingVersions.filter(\n                  v => v != updatedVersion.id,\n                ),\n              });\n            }),\n          )\n          .catch(error => {\n            this.setState({\n              updatingVersions: this.state.updatingVersions.filter(\n                v => v != version.id,\n              ),\n              alerts: this.state.alerts.concat({\n                variant: 'danger',\n                title: `API Error: ${error.response.status}`,\n                description:\n                  `Could not update the certification ` +\n                  `status for ${version.namespace}.` +\n                  `${version.name}.${version.version}.`,\n              }),\n            });\n          }),\n    );\n  }\n\n  private queryCollections() {\n    this.setState({ loading: true }, () =>\n      CollectionVersionAPI.list(this.state.params).then(result =>\n        this.setState({\n          versions: result.data.data,\n          itemCount: result.data.meta.count,\n          loading: false,\n          updatingVersions: [],\n        }),\n      ),\n    );\n  }\n\n  private get updateParams() {\n    return ParamHelper.updateParamsMixin();\n  }\n\n  private get closeAlert() {\n    return closeAlertMixin('alerts');\n  }\n}\n\nexport default withRouter(CertificationDashboard);\n"],"sourceRoot":""}