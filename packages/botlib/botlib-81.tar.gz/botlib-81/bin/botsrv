#!/usr/bin/python3 -u
# BOTLIB - Framework to program bots.
#
# bin/botsrv (bot service)

#import os,sys ; sys.path.insert(0, os.getcwd())

import bot
import lo
import logging
import os
import time

from bot.krn import Kernel
from lo.csl import Console
from lo.shl import execute, level, parse_cli

def main():
    lo.cdir("/var/lib/botd/store/")
    lo.cdir("/var/log/botd/")
    lo.workdir = "/var/lib/botd/"
    level("debug", "/var/log/botd/botd.log")
    logging.warning("BOTLIB %s started at %s" % (bot.__version__, time.ctime(time.time())))
    k = Kernel()
    k.cfg.last()
    mods = k.walk("bot")
    k.scan(mods)
    k.init(mods)
    k.start()
    k.wait()
    
execute(main)
os._exit(0)
